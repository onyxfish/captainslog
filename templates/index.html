<head>
    <title>Captain's Log</title>
</head>
<body>
    <h1>Captain's Log</h1>
    
    <div id="rail">
    Source:
    <ul name='source'>
        <li class='facet ${ 'selected' if selected_source == 'All' else '' }'>All</li>
        % for source in sources:
        <li class="facet ${ 'selected' if selected_source == source else '' }">${ source }</li>
        % endfor
    </ul>
    
    Date range:
    <ul name='when'>
        <li class='facet ${ 'selected' if selected_when == 'All' else '' }'>All</li>
        <li class='facet ${ 'selected' if selected_when == 'Today' else '' }'>Today</li>
        <li class='facet ${ 'selected' if selected_when == 'This Week' else '' }'>This Week</li>
        <li class='facet ${ 'selected' if selected_when == 'This Month' else '' }'>This Month</li>
        <li class='facet ${ 'selected' if selected_when == 'This Year' else '' }'>This Year</li>
    </ul>
    
    Host:
    <ul name='host'>
        <li class='facet ${ 'selected' if selected_host == 'All' else '' }'>All</li>
        % for host in hosts:
        <li class="facet ${ 'selected' if selected_host == host else '' }">${ host }</li>
        % endfor
    </ul>
    
    Path:
    <ul name='path'>
        <li class='facet ${ 'selected' if selected_path == 'All' else '' }'>All</li>
        % for path in paths:
        <li class='facet ${ 'selected' if selected_path == path else '' }'>${ path }</li>
        % endfor
    </ul>
    
    Status Code:
    <ul name='statuscode'>
        <li class='facet ${ 'selected' if selected_statuscode == 'All' else '' }'>All</li>
        % for statuscode in statuscodes:
        <li class='facet ${ 'selected' if selected_statuscode == statuscode else '' }'>${ statuscode }</li>
        % endfor
    </ul>
    </div>
    
    <div id="content">
        <table>
        <tr>
            <th>Source</th>
            <th>Host</th>
            <th>RFC931</th>
            <th>Username</th>
            <th>Datetime</th>
            <th>Verb</th>
            <th>Path</th>
            <th>Protocol</th>
            <th>Statuscode</th>
            <th>Bytes</th>
        </tr>
        % for event in events:
        <tr>
            <td>${ event['source'] }</td>
            <td>${ event['host'] }</td>
            <td>${ event['rfc931'] }</td>
            <td>${ event['username'] }</td>
            <td>${ event['when'] }</td>
            <td>${ event['verb'] }</td>
            <td>${ event['path'] }</td>
            <td>${ event['protocol'] }</td>
            <td>${ event['statuscode'] }</td>
            <td>${ event['bytes'] }</td>
        </tr>
        % endfor
        </table>
    </body>

    <link rel="stylesheet" type="text/css" href="assets/captainslog.css" />
    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
    <script type='text/javascript'>
    var q = {
        'source': '${ selected_source }',
        'when': '${ selected_when }',
        'host': '${ selected_host }',
        'path': '${ selected_path }',
        'statuscode': '${ selected_statuscode }'
        };
    
    function update_view() {
        params = new Array();
        
        for (var i in q) {
            params.push(i + '=' + q[i]);
        }
        
        window.location.href = '?' + params.join('&')
    }
    
    $(document).ready(function () {
        $('.facet').click(function() {
            q[$(this).parent().attr('name')] = $(this).text();
            
            update_view();
        });
    })
    </script>
</body>